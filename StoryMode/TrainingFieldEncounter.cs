using System.Collections.Generic;
using StoryMode.Missions;
using TaleWorlds.CampaignSystem;
using TaleWorlds.CampaignSystem.Encounters;
using TaleWorlds.CampaignSystem.Settlements;
using TaleWorlds.CampaignSystem.Settlements.Locations;
using TaleWorlds.Core;

namespace StoryMode;

public class TrainingFieldEncounter : LocationEncounter
{
	internal static void AutoGeneratedStaticCollectObjectsTrainingFieldEncounter(object o, List<object> collectedObjects)
	{
		((TrainingFieldEncounter)o).AutoGeneratedInstanceCollectObjects(collectedObjects);
	}

	protected virtual void AutoGeneratedInstanceCollectObjects(List<object> collectedObjects)
	{
	}

	public TrainingFieldEncounter(Settlement settlement)
		: base(settlement)
	{
	}

	public override IMission CreateAndOpenMissionController(Location nextLocation, Location previousLocation = null, CharacterObject talkToChar = null, string playerSpecialSpawnTag = null)
	{
		IMission result = null;
		if (nextLocation.StringId == "training_field")
		{
			int upgradeLevel = ((!Settlement.CurrentSettlement.IsTown) ? 1 : Settlement.CurrentSettlement.Town.GetWallLevel());
			result = StoryModeMissions.OpenTrainingFieldMission(nextLocation.GetSceneName(upgradeLevel), nextLocation);
		}
		return result;
	}
}
